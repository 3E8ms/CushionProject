<!DOCTYPE html>
 
<head>
    <meta charset="utf-8" />
</head>
<body>
    <h1>Input a URL down below</h1>
    <input type="url" id="url" name="url"><br>
    <input type="submit" value="Submit" onclick="query()">

    <div id="result"></div>
</body>

<script type="text/javascript" src="scraper.js">
  function query(){
  /*  const text = document.querySelector('.textfield').value
    fetch(url,{
      method: 'POST',
      headers:{
        'Content-Type':'application/json',
      },
      body: JSON.stringify({text})
    })*/
    const url = document.getElementById("url").value;
    if (!isValidUrl(url)) {
      alert ("url not valid");
      return;
    }
    alert(`Querying data from url ${url}`);
    const urlResult = scrapeText(url)
    console.log(urlResult)
  }
  function newText(text){
    const el = document.createTextNode(text)
    return el;
  }
  async function loadPage(){
    const ctr = document.querySelector('.container');
    const textField = newText('div',{class: 'text'});
  }
  
  /*
  document.getElementById("urlQuery").addEventListener("submit", query);
  function query() {
    
      document.getElementById("result").innerHTML = urlResult;
     // document.getElementById("url").value = null;
     */
    

  function getPageFromURL(url) {
    var xmlHttp = new XMLHttpRequest();
    xmlHttp.open("GET", url, true);
    xmlHttp.send();
    return xmlHttp.responseText;
  }

  function getWordFrequency(text) { 
      var textArray = text.split(" ")
      var dict = {}
      var arrayLen = textArray.length;
      for (i = 0; i < arrayLen; i++){
        if (textArray[i] in dict){
            dict[textArray[i]]++;
        }else{
            dict[textArray[i]]=1;
        }
      }
      var items = Object.keys(dict).map(function(key) {return [key, dict[key]];});
      items.sort(function(first, second) {
        return second[1] - first[1];
      });

      if (item.length<10){
        return item;
      }else{
      // Create a new array with only the first 10 items
        return items.slice(0, 10);
      }
    
  }

  function highlight(text) {
      var inputText = document.getElementById("inputText");
      var innerHTML = inputText.innerHTML;
      var index = innerHTML.indexOf(text);
      if (index >= 0) { 
      innerHTML = innerHTML.substring(0,index) + "<span class='highlight'>" + innerHTML.substring(index,index+text.length) + "</span>" + innerHTML.substring(index + text.length);
      inputText.innerHTML = innerHTML;
      }
}

  function extractContent(s) {
    var span = document.createElement('span');
    span.innerHTML = s;
    return span.textContent || span.innerText;
  }

  function getResultHTML(count) {
    let result = "";
    for (const k in count) {
      result += `<div>${k}: ${count[k]}</div>`;
    }
    return result;
  }

  function isValidUrl(string) {
    try {
      new URL(string);
    } catch (_) {
      return false;  
    }

    return true;
  }
</script>
</html>